{% extends 'base/base.html' %}
{% load static %}
{% block title %}Website{% endblock %}
{% block content %}

    <div class="page-wrapper">
            <div class="container-xl">
                <!-- Page title -->
                <div class="page-header d-print-none">
                    <div class="row align-items-center">
                        <div class="col">
                            <h2 class="page-title">
                                Report
                            </h2>
                        </div>
                        <!-- Page title actions -->
                        <div class="col-auto ms-auto d-print-none">
                            <button type="button" class="btn btn-primary" onclick="javascript:window.print();">
                                <!-- Download SVG icon from http://tabler-icons.io/i/printer -->
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24"
                                     viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                     stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2"></path>
                                    <path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4"></path>
                                    <rect x="7" y="13" width="10" height="8" rx="2"></rect>
                                </svg>
                                Print
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-body">
                <div class="container-xl card card-lg">

                    <div class="col-12">
                        <br>
                        <h2>Report {{ scan.address }} : </h2>
                        <p class="mb-1">Information : {{ scan.information_risk_count }}</p>
                        <p class="mb-1">Low : {{ scan.low_risk_count }}</p>
                        <p class="mb-1">Medium : {{ scan.medium_risk_count }}</p>
                        <p class="mb-1">High : {{ scan.high_risk_count }}</p>
                        <p class="mb-1">Critical : {{ scan.critical_risk_count }}</p>
                        <br>
                    </div>

                    <table class="table table-transparent table-responsive">
                        <h2>Descriptions : </h2>
                        <thead>
                        <tr>
                            <th class="text-center" style="width: 1%">ID</th>
                            <th>Name</th>
                            <th class="text-center" style="width: 1%">Tool</th>
                            <th class="text-end" style="width: 1%">Risk</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for item in scan.found %}
                            <tr>
                                <td class="text-center">{{ item.id }}</td>
                                <td>
                                    <p class="strong mb-1">{{ item.vulnerability_name }}</p>
                                    <div class="text-muted">{{ item.description }}</div>
                                </td>
                                <td class="text-center">
                                    {{ item.tool_name }}
                                </td>
                                <td class="text-end">{{ item.risk }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <p class="text-center mt-1">Thank You Very Much For Doing Business With Us . <br> Dionaea Team </p>
                </div>
            </div>
        </div>

{% endblock %}